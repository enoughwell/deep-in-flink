<svg width="632.862" height="495.709" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="svg2" overflow="hidden"><defs id="defs4"></defs><g id="layer1" transform="translate(-89.2883 -87.3701)"><g id="g2989" transform="translate(65.1321 66.9639)"><text id="text2991" fill="#000000" font-family="verdana" font-style="italic" font-weight="400" font-size="11.2528" text-anchor="start" x="571.352" y="45.8041">Source</text><text id="text2993" fill="#843C0C" font-family="courier new" font-style="normal" font-weight="700" font-size="13.8034" text-anchor="start" x="25.3045" y="37.7655">DataStream</text><text id="text2995" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="107.975" y="37.7655">&lt;</text><text id="text2997" fill="#5B9BD5" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="116.227" y="37.7655">String</text><text id="text2999" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="166.04" y="37.7655">&gt;</text><text id="text3001" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="182.694" y="37.7655">lines =</text><text id="text3003" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="248.86" y="37.7655">env.</text><text id="text3005" fill="#843C0C" font-family="courier new" font-style="normal" font-weight="700" font-size="13.8034" text-anchor="start" x="282.018" y="37.7655">addSource</text><text id="text3007" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="356.587" y="37.7655">(</text><text id="text3009" fill="#2F5597" font-family="courier new" font-style="normal" font-weight="700" font-size="13.8034" text-anchor="start" x="282.018" y="54.2696">new</text><text id="text3011" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="315.177" y="54.2696">FlinkKafkaConsumer</text><text id="text3013" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="464.314" y="54.2696">&lt;&gt;(â€¦));</text><text id="text3015" fill="#843C0C" font-family="courier new" font-style="normal" font-weight="700" font-size="13.8034" text-anchor="start" x="25.3045" y="87.2778">DataStream</text><text id="text3017" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="107.975" y="87.2778">&lt;</text><text id="text3019" fill="#5B9BD5" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="116.227" y="87.2778">Event</text><text id="text3021" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="157.788" y="87.2778">&gt; events =</text><text id="text3023" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="248.86" y="87.2778">lines.</text><text id="text3025" fill="#843C0C" font-family="courier new" font-style="normal" font-weight="700" font-size="13.8034" text-anchor="start" x="298.523" y="87.2778">map</text><text id="text3027" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="323.579" y="87.2778">((line)</text><text id="text3029" fill="#2F5597" font-family="courier new" font-style="normal" font-weight="700" font-size="13.8034" text-anchor="start" x="389.745" y="87.2778">-</text><text id="text3031" fill="#2F5597" font-family="courier new" font-style="normal" font-weight="700" font-size="13.8034" text-anchor="start" x="397.997" y="87.2778">&gt;</text><text id="text3033" fill="#000000" font-family="courier new" font-style="italic" font-weight="400" font-size="13.8034" text-anchor="start" x="414.501" y="87.2778">parse</text><text id="text3035" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="456.062" y="87.2778">(line));</text><text id="text3037" fill="#843C0C" font-family="courier new" font-style="normal" font-weight="700" font-size="13.8034" text-anchor="start" x="25.3045" y="120.286">DataStream</text><text id="text3039" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="107.975" y="120.286">&lt;</text><text id="text3041" fill="#5B9BD5" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="116.227" y="120.286">Statistics</text><text id="text3043" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="199.198" y="120.286">&gt; stats = events</text><text id="text3045" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="91.471" y="136.79">.</text><text id="text3047" fill="#843C0C" font-family="courier new" font-style="normal" font-weight="700" font-size="13.8034" text-anchor="start" x="99.7231" y="136.79">keyBy</text><text id="text3049" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="141.133" y="136.79">(</text><text id="text3051" fill="#548235" font-family="courier new" font-style="normal" font-weight="700" font-size="13.8034" text-anchor="start" x="149.385" y="136.79">"id"</text><text id="text3053" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="182.694" y="136.79">)</text><text id="text3055" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="91.471" y="153.294">.</text><text id="text3057" fill="#843C0C" font-family="courier new" font-style="normal" font-weight="700" font-size="13.8034" text-anchor="start" x="99.7231" y="153.294">timeWindow</text><text id="text3059" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="182.694" y="153.294">(</text><text id="text3061" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="190.946" y="153.294">Time.seconds</text><text id="text3063" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="290.271" y="153.294">(10))</text><text id="text3065" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="91.471" y="169.798">.</text><text id="text3067" fill="#843C0C" font-family="courier new" font-style="normal" font-weight="700" font-size="13.8034" text-anchor="start" x="99.7231" y="169.798">apply</text><text id="text3069" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="141.133" y="169.798">(</text><text id="text3071" fill="#2F5597" font-family="courier new" font-style="normal" font-weight="700" font-size="13.8034" text-anchor="start" x="149.385" y="169.798">new</text><text id="text3073" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="182.694" y="169.798">MyWindowAggregationFunction</text><text id="text3075" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="406.249" y="169.798">());</text><text id="text3077" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="25.3045" y="202.807">stats.</text><text id="text3079" fill="#843C0C" font-family="courier new" font-style="normal" font-weight="700" font-size="13.8034" text-anchor="start" x="74.8169" y="202.807">addSink</text><text id="text3081" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="132.881" y="202.807">(</text><text id="text3083" fill="#2F5597" font-family="courier new" font-style="normal" font-weight="700" font-size="13.8034" text-anchor="start" x="141.133" y="202.807">new</text><text id="text3085" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="174.442" y="202.807">RollingSink</text><text id="text3087" fill="#000000" font-family="courier new" font-style="normal" font-weight="400" font-size="13.8034" text-anchor="start" x="265.364" y="202.807">(path));</text><path d="M32.4456 379.407C32.4456 361.703 46.7554 347.355 64.4035 347.355 82.0517 347.355 96.3615 361.703 96.3615 379.407 96.3615 397.093 82.0517 411.44 64.4035 411.44 46.7554 411.44 32.4456 397.093 32.4456 379.407" id="path3089" stroke="none" fill="#FFD966" fill-rule="evenodd" fill-opacity="1"/><text id="text3091" fill="#000000" font-family="verdana" font-style="normal" font-weight="400" font-size="10.0525" text-anchor="start" x="46.9743" y="383.35">Source</text><path d="M170.442 379.407C170.442 361.703 184.79 347.355 202.475 347.355 220.18 347.355 234.527 361.703 234.527 379.407 234.527 397.093 220.18 411.44 202.475 411.44 184.79 411.44 170.442 397.093 170.442 379.407" id="path3093" stroke="none" fill="#FFD966" fill-rule="evenodd" fill-opacity="1"/><text id="text3095" fill="#000000" font-family="verdana" font-style="normal" font-weight="400" font-size="10.0525" text-anchor="start" x="187.062" y="383.35">map()</text><path d="M104.182 375.187 154.351 375.187 154.351 370.967 162.791 379.407 154.351 387.847 154.351 383.627 104.182 383.627Z" id="path3097" stroke="none" fill="#BFBFBF" fill-rule="evenodd" fill-opacity="1"/><path d="M532.558 21.024C537.49 21.024 541.466 21.6992 541.466 22.5244L541.466 40.0225C541.466 40.8477 545.461 41.5041 550.375 41.5041 545.461 41.5041 541.466 42.1793 541.466 42.9857L541.466 60.5026C541.466 61.309 537.49 61.9842 532.558 61.9842" id="path3099" stroke="#000000" stroke-width="1.25656" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-dasharray="" stroke-opacity="1" fill="none"/><path d="M532.558 70.5738C537.49 70.5738 541.466 71.249 541.466 72.0555L541.466 81.8266C541.466 82.6518 545.461 83.3083 550.375 83.3083 545.461 83.3083 541.466 83.9834 541.466 84.7899L541.466 94.5611C541.466 95.3863 537.49 96.0427 532.558 96.0427" id="path3101" stroke="#000000" stroke-width="1.25656" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-dasharray="" stroke-opacity="1" fill="none"/><path d="M532.089 104.651C537.021 104.651 540.997 105.307 540.997 106.133L540.997 139.966C540.997 140.791 544.992 141.448 549.906 141.448 544.992 141.448 540.997 142.123 540.997 142.929L540.997 176.782C540.997 177.588 537.021 178.263 532.089 178.263" id="path3103" stroke="#000000" stroke-width="1.25656" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-dasharray="" stroke-opacity="1" fill="none"/><path d="M532.089 188.259C537.021 188.259 540.997 188.935 540.997 189.741L540.997 199.362C540.997 200.187 544.992 200.844 549.906 200.844 544.992 200.844 540.997 201.5 540.997 202.325L540.997 211.947C540.997 212.753 537.021 213.428 532.089 213.428" id="path3105" stroke="#000000" stroke-width="1.25656" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-dasharray="" stroke-opacity="1" fill="none"/><text id="text3107" fill="#000000" font-family="verdana" font-style="italic" font-weight="400" font-size="11.2528" text-anchor="start" x="571.352" y="86.2265">Transformation</text><text id="text3109" fill="#000000" font-family="verdana" font-style="italic" font-weight="400" font-size="11.2528" text-anchor="start" x="571.352" y="145.722">Transformation</text><text id="text3111" fill="#000000" font-family="verdana" font-style="italic" font-weight="400" font-size="11.2528" text-anchor="start" x="94.2095" y="313.348">Source</text><text id="text3113" fill="#000000" font-family="verdana" font-style="italic" font-weight="400" font-size="11.2528" text-anchor="start" x="88.5081" y="326.852">Operator</text><path d="M242.179 375.187 292.348 375.187 292.348 370.967 300.787 379.407 292.348 387.847 292.348 383.627 242.179 383.627Z" id="path3115" stroke="none" fill="#BFBFBF" fill-rule="evenodd" fill-opacity="1"/><path d="M308.439 379.407C308.439 361.703 322.787 347.355 340.491 347.355 358.177 347.355 372.524 361.703 372.524 379.407 372.524 397.093 358.177 411.44 340.491 411.44 322.787 411.44 308.439 397.093 308.439 379.407" id="path3117" stroke="none" fill="#FFD966" fill-rule="evenodd" fill-opacity="1"/><text id="text3119" fill="#000000" font-family="verdana" font-style="normal" font-weight="400" font-size="10.0525" text-anchor="start" x="318.245" y="371.347">keyBy</text><text id="text3121" fill="#000000" font-family="verdana" font-style="normal" font-weight="400" font-size="10.0525" text-anchor="start" x="349.153" y="371.347">()/</text><text id="text3123" fill="#000000" font-family="verdana" font-style="normal" font-weight="400" font-size="10.0525" text-anchor="start" x="314.794" y="383.35">window()/</text><text id="text3125" fill="#000000" font-family="verdana" font-style="normal" font-weight="400" font-size="10.0525" text-anchor="start" x="322.296" y="395.353">apply()</text><path d="M380.176 375.187 430.345 375.187 430.345 370.967 438.784 379.407 430.345 387.847 430.345 383.627 380.176 383.627Z" id="path3127" stroke="none" fill="#BFBFBF" fill-rule="evenodd" fill-opacity="1"/><path d="M446.455 379.407C446.455 361.703 460.802 347.355 478.488 347.355 496.192 347.355 510.521 361.703 510.521 379.407 510.521 397.093 496.192 411.44 478.488 411.44 460.802 411.44 446.455 397.093 446.455 379.407" id="path3129" stroke="none" fill="#FFD966" fill-rule="evenodd" fill-opacity="1"/><text id="text3131" fill="#000000" font-family="verdana" font-style="normal" font-weight="400" font-size="10.0525" text-anchor="start" x="467.476" y="383.35">Sink</text><path d="M240.454 250.469 257.464 250.469 257.464 234.208 291.448 234.208 291.448 250.469 308.439 250.469 274.456 266.71Z" id="path3133" stroke="#000000" stroke-width="1.25656" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-dasharray="" stroke-opacity="1" fill="none"/><text id="text3135" fill="#000000" font-family="verdana" font-style="italic" font-weight="400" font-size="11.2528" text-anchor="start" x="227.004" y="313.348">Transformation</text><text id="text3137" fill="#000000" font-family="verdana" font-style="italic" font-weight="400" font-size="11.2528" text-anchor="start" x="242.007" y="326.852">Operators</text><text id="text3139" fill="#000000" font-family="verdana" font-style="italic" font-weight="400" font-size="11.2528" text-anchor="start" x="438.992" y="313.348">Sink</text><text id="text3141" fill="#000000" font-family="verdana" font-style="italic" font-weight="400" font-size="11.2528" text-anchor="start" x="426.088" y="326.852">Operator</text><path d="M451.65 333.721 457.276 341.935 456.245 342.629 450.618 334.433 451.65 333.721ZM458.102 339.835 458.871 345.367 453.976 342.667 458.102 339.835Z" id="path3143" stroke="#000000" stroke-width="0.0187547" stroke-linecap="butt" stroke-linejoin="round" stroke-dasharray="" stroke-opacity="1" fill="#000000" fill-rule="nonzero" fill-opacity="1"/><path d="M89.5911 331.583 84.9024 339.628 85.9714 340.266 90.6601 332.202 89.5911 331.583ZM83.9084 337.603 83.5521 343.192 88.222 340.116 83.9084 337.603Z" id="path3145" stroke="#000000" stroke-width="0.0187547" stroke-linecap="butt" stroke-linejoin="round" stroke-dasharray="" stroke-opacity="1" fill="#000000" fill-rule="nonzero" fill-opacity="1"/><path d="M234.04 329.407 221.118 342.216 221.999 343.098 234.921 330.307 234.04 329.407ZM220.686 340.003 218.886 345.292 224.212 343.548 220.686 340.003Z" id="path3147" stroke="#000000" stroke-width="0.0187547" stroke-linecap="butt" stroke-linejoin="round" stroke-dasharray="" stroke-opacity="1" fill="#000000" fill-rule="nonzero" fill-opacity="1"/><path d="M301.219 329.407 316.729 344.129 315.866 345.03 300.356 330.307 301.219 329.407ZM317.104 341.898 319.017 347.168 313.672 345.536 317.104 341.898Z" id="path3149" stroke="#000000" stroke-width="0.0187547" stroke-linecap="butt" stroke-linejoin="round" stroke-dasharray="" stroke-opacity="1" fill="#000000" fill-rule="nonzero" fill-opacity="1"/><path d="M241.729 447.918 154.538 393.342 155.195 392.273 242.404 446.849 241.729 447.918ZM154.595 395.592 151.688 390.81 157.258 391.354 154.595 395.592Z" id="path3151" stroke="#000000" stroke-width="0.0187547" stroke-linecap="butt" stroke-linejoin="round" stroke-dasharray="" stroke-opacity="1" fill="#000000" fill-rule="nonzero" fill-opacity="1"/><text id="text3153" fill="#000000" font-family="verdana" font-style="italic" font-weight="400" font-size="11.2528" text-anchor="start" x="245.671" y="463.081">Stream</text><path d="M291.373 447.974 394.279 398.631 393.736 397.505 290.829 446.849 291.373 447.974ZM393.961 400.862 397.374 396.436 391.785 396.342 393.961 400.862Z" id="path3155" stroke="#000000" stroke-width="0.0187547" stroke-linecap="butt" stroke-linejoin="round" stroke-dasharray="" stroke-opacity="1" fill="#000000" fill-rule="nonzero" fill-opacity="1"/><path d="M270.78 440.922 270.78 401.125 269.523 401.125 269.523 440.922 270.78 440.922ZM272.655 402.382 270.161 397.374 267.648 402.382 272.655 402.382Z" id="path3157" stroke="#000000" stroke-width="0.0187547" stroke-linecap="butt" stroke-linejoin="round" stroke-dasharray="" stroke-opacity="1" fill="#000000" fill-rule="nonzero" fill-opacity="1"/><text id="text3159" fill="#000000" font-family="verdana" font-style="italic" font-weight="400" font-size="11.2528" text-anchor="start" x="571.352" y="205.128">Sink</text><path d="M516.935 463.334C516.935 471.492 515.828 478.094 514.478 478.094L273.331 478.094C271.961 478.094 270.855 484.715 270.855 492.873 270.855 484.715 269.767 478.094 268.398 478.094L27.2505 478.094C25.8814 478.094 24.7749 471.492 24.7749 463.334" id="path3161" stroke="#000000" stroke-width="1.25656" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-dasharray="" stroke-opacity="1" fill="none"/><text id="text3163" fill="#000000" font-family="verdana" font-style="italic" font-weight="400" font-size="11.2528" text-anchor="start" x="214.032" y="513.791">Streaming Dataflow</text><text id="text3257" stroke="none" fill="#000000" fill-opacity="1" font-family="sans" font-style="normal" font-weight="400" font-size="40" letter-spacing="0" word-spacing="0" transform="translate(24.1563 20.4063)" x="-125.259" y="179.026"><tspan x="-125.259" y="179.026"></tspan></text></g></g></svg>